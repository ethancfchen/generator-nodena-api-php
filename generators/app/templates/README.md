# <%= appname %>

> Generated by [nodena-api-php][npm-url]

## Information

## Runtime

*   [Git][Git]
*   [Node.js][Node.js]
    *   [Gulp][Gulp]
*   [PHP][PHP]
    *   [Composer][Composer]
*   Optional Node Packages
    *   [ESLint][ESLint]
*   Optional PHP Packages
    *   [PHP_CodeSniffer][PHP_CodeSniffer]

## File Structure

| File/Directory              | Description                                                 |
|-----------------------------|-------------------------------------------------------------|
| `setup/`                    | Project setup helpers                                       |
| `setup/base/`               | Project setup base                                          |
| `setup/base/assets.js`      | Project base asset                                          |
| `setup/base/plugins.js`     | Project base plugin setup details                           |
| `setup/plugins/`            | Project plugin setup details                                |
| `setup/assets.js`           | Extended project assets                                     |
| `setup/plugins.js`          | Extended project plugin setups                              |
| `setup/setup.js`            | Main setup helpers                                          |
| `gulp-tasks/`               | [Gulp][Gulp] task definitions                               |
| `src/`                      | Source files                                                |
| `res/`                      | Resources, including docs, sql, etc.                        |
| `res/changelog.template.md` | Markdown template for changelog                             |
| `dist/`                     | Temporary build files for developement/debug                |
| `online/`                   | Files for online sites                                      |
| `online/stage/`             | Files for stage site                                        |
| `online/live/`              | Files for live site                                         |
| `online/patches/`           | Patch files for each version                                |
| `node_modules/`             | Dependent packages for Node.js                              |
| `vendor/`                   | Dependent packages for [Composer][Composer]                 |
| `.editorconfig`             | Editor config file for editors                              |
| `.eslintrc`                 | Setup file for [ESlint][ESlint]                             |
| `.gitignore`                | Ignored files list for [Git][Git]                           |
| `gulpfile.js`               | Project main workflow                                       |
| `gulptasks.js`              | Custom task loader for [gulp-task-loader][gulp-task-loader] |
| `package.json`              | Project meta information                                    |
| `composer.json`             | [Composer][Composer] dependency information                 |
| `setup.json`                | Project setup variables                                     |
| `README.md`                 | This readme file                                            |
| `CHANGELOG.md`              | Auto generated change log                                   |

## Environment Setup (`setup.json`)

### root

Default: `api/`

Path to project root, it'll be created if not exist.

Example:

```json
{
  "root": "cms/"
}
```

### server

Options for [BrowserSync][BrowserSync].

Options:

*   `port` - Default port. Default: `8888`.
*   `https` - Enable self-signed SSL. Default: `false`.

Example:

```json
{
  "server": {
    "port": 8888,
    "https": true
  }
}
```

### globals

Default: `null`

Define constant variables.

Options:

*   `php` - Variables will be injected by [`gulp-preprocess`][gulp-preprocess] to all PHP files.

Example:

```json
{
  "globals": {
    "php": {
      "dbConnect": {
        "dsn": "localhost",
        "username": "root",
        "password": "root"
      }
    }
  }
}
```

In PHP files:

```php
define('DB_DSN', '/* @echo dbConnect.dsn */');
```

### preprocess

Default: `null`

Extra settings for [gulp-preprocess][gulp-preprocess].

Options:

*   `filter` - Assign a filter, using [gulp-filter][gulp-filter].
    *   `php` - Filter on source files.

Example:

```json
{
  "preprocess": {
    "filter": {
      "php": ["**/*.php"]
    }
  }
}
```

### Environment Variable

Override constants for different environments.

Avaliable: `local`, `bypass`, `stage`, `live`.

Options:

*   `globals` - Override `globals` variables.

Example:

```json
{
  "stage": {
    "globals": {
      "php": {
        "dbConnect": {
          "dsn": "localhost",
          "username": "root",
          "password": "root"
        }
      }
    }
  },
  "live": {
    "globals": {
      "php": {
        "dbConnect": {
          "dsn": "192.168.0.10",
          "username": "root",
          "password": "root"
        }
      }
    }
  }
}
```

## Build/Publish

### Build For Developement

Build the website and open live preview with [BrowserSync][BrowserSync].

```bash
gulp
```

### Build For Test/Debug in Published Environment (Bypass)

Build the website and open live preview with [BrowserSync][BrowserSync].

```bash
gulp bypass
```

### Publish For Stage Site

Build the website for stage,all files will generated in ```online/stage/```
and create a version patch to ```online/patches/<version>```.

```bash
gulp stage
```

### Publish For Live Site

Build the website for stage, all files will generated in ```online/live/```
and create a version patch to ```online/patches/<version>```.

```bash
gulp live
```

### Options

#### Version (default: prerelease/patch)

Increace version number using [semver][semver].

##### Prerelease (Only for stage) => 1.0.x-stage.x

```bash
gulp stage
```

##### Patch (Only for live)

```bash
gulp live
```

##### Minor (Only for live) => 1.x.0

```bash
gulp live -v minor
```

##### Major (Only for live) => x.0.0

```bash
gulp live -v major
```

##### Manually (Only for live)

```bash
gulp live -v 1.0.1
```

#### Port for BrowserSync (default: 8888)

Manually assign the port of live preview.

```bash
gulp -p 8899
```

## Change Log

[Changelog](CHANGELOG.md)

[BrowserSync]: https://www.browsersync.io/
[Composer]: https://getcomposer.org/
[ESLint]: http://eslint.org/
[Git]: https://git-scm.com/
[Gulp]: http://gulpjs.com/
[Node.js]: https://nodejs.org/
[PHP]: http://php.net/
[PHP_CodeSniffer]: http://pear.php.net/package/PHP_CodeSniffer/
[gulp-filter]: https://github.com/sindresorhus/gulp-filter/
[gulp-preprocess]: https://github.com/jas/gulp-preprocess/
[gulp-task-loader]: https://github.com/hontas/gulp-task-loader/
[npm-url]: https://npmjs.org/package/generator-nodena-api-php/
[semver]: https://github.com/npm/node-semver/
